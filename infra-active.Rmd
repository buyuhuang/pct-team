---
title: 'Assessing the risks and opportunities of major transport infrastructure projects for active travel: a geographical approach'
author: "Robin Lovelace"
date: "`r Sys.Date()`"
output: bookdown::html_document2
bibliography: documents/references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = F)
pkgs = c("sp", "tmap", "rgeos", "stplanr")
lapply(pkgs, library, character.only = T)
```

# Abstract {-}

The impacts of major infrastrucuture pojects on many aspects of life are well established. However, the impacts on other modes of travel, particularly walking and cycling, have been under-explored. The paper sets out to fill this research gap, using Geographic Information Systems (GIS). The method is developed in theoretical terms, focussing on risks of 'severance' and opportunities associated with active travel 'desire lines' that run parallel to proposed routes. Then it is applied to a large scale case study: the planned construction of a high-speed rail network on the UK (HS2). This empirical case study demonstrates that the method is scalable yet able to identify risks and opportunites at local levels, down to road segments, which could guide pro-cycling interventions associated with construction or provide a source of evidence to re-assess the overall impacts of major infrastructure projects.

# Introduction

Major transport infrastructure projects are 

# Methods for assessing the impacts of major infrastructure projects: a review



# A typology of 

# Method

# Case studies

## Cycling potential surrounding the Lewes-Uckfield trainline

```{r, echo=FALSE, warning=FALSE}
# Basic stats on Lewes-Uckfield route
lewes_uckfield = readRDS("input-data/lewes_uckfield.Rds")
lewes_uckfield_osgb = spTransform(lewes_uckfield, CRS("+init=epsg:27700"))
# gLength(lewes_uckfield_osgb) / 1000
z = readRDS("../pct-bigdata/ukmsoas-scenarios.Rds")
l = readRDS("../pct-bigdata/pct_lines_oneway_shapes.Rds")
l$`Percent cycling` = l$bicycle / l$all * 100
cents = geojsonio::geojson_read("../pct-bigdata/cents-scenarios.geojson", what = "sp")

# names(cents)
buff = buff_geo(lewes_uckfield, width = 10000)
proj4string(cents) = proj4string(lewes_uckfield)
cents_lc = cents[buff,]
z_lc = z[cents_lc,]
l_lc = l[buff,]
# plot(cents_lc)
# sum(cents_lc$all)
```

The Lewes-Uckfield trainline is a proposed project to restore a rail link between Uckfield and Lewes. This is part of wider plans to increase rail capacity in the area. The section of the route analysed in this section is 16 km in length. There are `r nrow(cents_lc)` MSOAs whose population weighted centroids lie within a 10 km buffer of the line, representing `r sum(cents_lc$all)` commuters. This area is illustrated in Figure \@ref(fig:lc).

```{r lc, fig.cap="Overview of the Lewes-Uckfiled line"}
# osm_tiles = read_osm(bb(z_lc, 1.05))
# saveRDS(osm_tiles, "data-sources/osm_tiles_ukfield.Rds")
osm_tiles = readRDS("data-sources/osm_tiles_ukfield.Rds")
m = qtm(osm_tiles) +
  tm_shape(buff) + tm_borders(col = "blue", lwd = 3) +
  tm_shape(l_lc) + tm_lines(lwd = "all", scale = 20, col = "Percent cycling", alpha = 0.5, n = 5, breaks = 2^(-1:4),
                              palette = "Spectral", auto.palette.mapping = F, ) +
  tm_shape(lewes_uckfield) + tm_lines(lwd = 5, col = "black") 
knitr::include_graphics("figures/lewes-uckfield-overview.png")
```

The total number of single-stage commutes that pass through the buffer is higher: `sum(l_lc$all)` commuters. As Figure \@ref(fig:lc) illustrates, many of these commuters would not interact with the rail line, as they are focused on commutes between Brighton and surrounding settlements in the far southeast of the 20 km buffer. Only a few hundred commutes pass directly parallel to the route, mostly due to 10 to 20 km (route distance) commutes between MSOAs in Lewes, Ringmer and Uckfield. Thus cycle paths running parallel to the rail line itself seem to have quite low commuter cycling potential.

Under the ambitious Ebike scenario, the PCT shows that cycling potential along routes running parallel to the line is uneven geographically. Unsurprisingly, cycling potential is clustered at either end of the proposed route, with relatively high increases modelled along segments of the network between Lewes and Ringmer (an increase from 35 to 336 commuters is modelled along a section of the B2192 running west from Lewes) and routes running north-south through Uckfield. This is shown in Figure \@ref(fig:pct-uck).

```{r pct-uck, fig.cap="Cycling potential along the transport network between Lewes and Uckfield, under the Ebike scenario of the Propensity to Cycle Tool (see [pct.bike/east-sussex/](http://pct.bike/east-sussex/))."}
knitr::include_graphics("figures/lewes-uckfield-pct-ebike.png")

```



<!-- ## The impacts of high speed rail on cycling in the UK -->

<!-- To assess the potential benefits of new crossings for cycling uptake during and after construction of HS2, the method was applied to geographical data about the route and current travel patterns surrounding it. The first stage was to identify all commutes that could potentially be directly affected by the HS2 infrastructure, by selecting all commuter desire lines that pass anywhere within a 20 km buffer. This is illustrated in Figure xx. -->

<!-- ```{r} -->
<!-- hs2 = readRDS("input-data/hs2.Rds") -->
<!-- l = readRDS("input-data/l_mini.Rds") -->
<!-- proj4string(hs2) = proj4string(l) -->
<!-- hs2_buf20 = stplanr::buff_geo(hs2, 20000) -->
<!-- # l = readRDS("../pct-bigdata/pct_lines_oneway_shapes.Rds") -->
<!-- l_sev = l[hs2,] -->
<!-- l_sam = l[sample(nrow(l), 1000),] # work with sample (comment for all) -->
<!-- # osm_tiles = read_osm(bb(hs2, ext = 1.2)) -->
<!-- # saveRDS(osm_tiles, "input-data/osm_tiles_hs2.Rds") -->
<!-- l_buf = l[hs2_buf20,] -->
<!-- osm_tiles = readRDS("input-data/osm_tiles_hs2.Rds") -->
<!-- qtm(osm_tiles) + -->
<!--   qtm(l_buf, line.col = "blue") + -->
<!--   qtm(hs2, line.col = "black", line.lwd = 3) + -->
<!--   tm_shape(hs2_buf20) + -->
<!--   tm_borders(lwd = 4) -->
<!-- # select lines that cross the route -->

<!-- ``` -->

<!-- ###  Cycling potential along the the HS2 route -->

<!-- ### Opportunities to reduce severance -->


<!-- ```{r, fig.cap="Overview of the proposed HS2 route, overlaid with a sample of commute desire lines (grey) and all desire lines that cross the proposed route."} -->

<!-- osm_tiles = readRDS("input-data/osm_tiles_hs2.Rds") -->
<!-- qtm(osm_tiles) + -->
<!--   qtm(hs2, line.col = "black", line.lwd = 3) + -->
<!--   qtm(l_sam, line.col = "blue") + -->
<!--   qtm(l_sev) -->
<!-- # select lines that cross the route -->
<!-- ``` -->


# Discussion

# References

Ideas:
<!-- Use a regression mode of distance to transport infrastructure to estimate deterrant of motorways - and therefore how it could be mitigated. Outliers with high cycling relative to road proximity could show how to mitigat negative impact. -->